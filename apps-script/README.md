# Google Sheets –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏)

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —á–∏—Ç–∞–µ—Ç/–ø–∏—à–µ—Ç —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –≤ Google Sheets —á–µ—Ä–µ–∑ **Google Apps Script Web App**.

## 1) –ü–æ–¥–≥–æ—Ç–æ–≤—å —Ç–∞–±–ª–∏—Ü—É

- –í Google Sheets —Å–æ–∑–¥–∞–π —Ñ–∞–π–ª (—É —Ç–µ–±—è –æ–Ω —É–∂–µ –µ—Å—Ç—å).
- –õ–∏—Å—Ç –º–æ–∂–Ω–æ –Ω–∞–∑–≤–∞—Ç—å `Employees` (–∏–ª–∏ –ø–æ–º–µ–Ω—è–π `SHEET_NAME` –≤ `apps-script/EmployeesApi.gs`).
- –ó–∞–≥–æ–ª–æ–≤–∫–∏ –≤ –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å:
  - `–§–ò–û`
  - `Email`
  - `–¢–µ–ª–µ—Ñ–æ–Ω`
  - `–î–æ–ª–∂–Ω–æ—Å—Ç—å`
  - `–†–∞–±–æ—á–∏–µ —Ç–æ—á–∫–∏`
- –°–∫—Ä–∏–ø—Ç —Å–∞–º –¥–æ–±–∞–≤–∏—Ç —Å–∫—Ä—ã—Ç—É—é –∫–æ–ª–æ–Ω–∫—É `__id` (–¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–≥–æ ID).

–ü–æ–ª–µ **–†–∞–±–æ—á–∏–µ —Ç–æ—á–∫–∏** —Ö—Ä–∞–Ω–∏—Ç—Å—è –∫–∞–∫ `1,2,3` (ID –ª–æ–∫–∞—Ü–∏–π).

## 2) –°–æ–∑–¥–∞–π Apps Script

1. –í —Ç–∞–±–ª–∏—Ü–µ: **–†–∞—Å—à–∏—Ä–µ–Ω–∏—è ‚Üí Apps Script**
2. –í—Å—Ç–∞–≤—å –∫–æ–¥ –∏–∑ `apps-script/EmployeesApi.gs` –≤ –ø—Ä–æ–µ–∫—Ç Apps Script.
3. –°–æ—Ö—Ä–∞–Ω–∏ –ø—Ä–æ–µ–∫—Ç (Ctrl+S –∏–ª–∏ Cmd+S)
4. –ù–∞–∂–º–∏ **Deploy ‚Üí New deployment**
5. –ù–∞–∂–º–∏ –Ω–∞ –∏–∫–æ–Ω–∫—É ‚öôÔ∏è (—à–µ—Å—Ç–µ—Ä–µ–Ω–∫–∞) —Ä—è–¥–æ–º —Å "Select type" ‚Üí –≤—ã–±–µ—Ä–∏ **Web app**
6. **Execute as**: **Me** (—Ç–≤–æ–π –∞–∫–∫–∞—É–Ω—Ç)
7. **Who has access**: **Anyone** (–í–ê–ñ–ù–û! –ù–µ "Only myself")
8. –ù–∞–∂–º–∏ **Deploy**
9. –°–∫–æ–ø–∏—Ä—É–π URL –≤–∏–¥–∞ `https://script.google.com/macros/s/XXX/exec` (–∏—Å–ø–æ–ª—å–∑—É–π `/exec`, –ù–ï `/dev`)

### ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏

–û—Ç–∫—Ä–æ–π —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã–π URL `/exec?action=list` –≤ **–Ω–æ–≤–æ–º –æ–∫–Ω–µ –±—Ä–∞—É–∑–µ—Ä–∞** (–∏–ª–∏ –≤ —Ä–µ–∂–∏–º–µ –∏–Ω–∫–æ–≥–Ω–∏—Ç–æ).

- ‚úÖ **–ï—Å–ª–∏ –≤–∏–¥–∏—à—å JSON** `{"employees":[]}` ‚Üí –≤—Å—ë –ø—Ä–∞–≤–∏–ª—å–Ω–æ!
- ‚ùå **–ï—Å–ª–∏ –≤–∏–¥–∏—à—å —Å—Ç—Ä–∞–Ω–∏—Ü—É "Sign in"** ‚Üí –¥–æ—Å—Ç—É–ø –≤—ã—Å—Ç–∞–≤–ª–µ–Ω –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ, –ø–µ—Ä–µ–ø—É–±–ª–∏–∫—É–π —Å "Anyone"
- ‚ùå **–ï—Å–ª–∏ –≤–∏–¥–∏—à—å "Authorization required"** ‚Üí –ø–µ—Ä–µ–ø—É–±–ª–∏–∫—É–π —Å "Anyone"

### üîÑ –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –∫–æ–¥–µ

–ï—Å–ª–∏ —Ç—ã –∏–∑–º–µ–Ω–∏–ª –∫–æ–¥ Apps Script:
1. –°–æ—Ö—Ä–∞–Ω–∏ –ø—Ä–æ–µ–∫—Ç
2. **Deploy ‚Üí Manage deployments**
3. –ù–∞–∂–º–∏ ‚úèÔ∏è (Edit) —É —Ç–µ–∫—É—â–µ–≥–æ deployment
4. –í—ã–±–µ—Ä–∏ **New version**
5. –ù–∞–∂–º–∏ **Deploy**
6. URL –æ—Å—Ç–∞–Ω–µ—Ç—Å—è —Ç–æ—Ç –∂–µ, –Ω–æ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –Ω–æ–≤–∞—è –≤–µ—Ä—Å–∏—è –∫–æ–¥–∞

## 3) –ü–æ–¥–∫–ª—é—á–∏ URL –≤ —Ñ—Ä–æ–Ω—Ç–µ

–í `src/services/googleSheetsService.js` –º–æ–∂–Ω–æ:

- –æ—Å—Ç–∞–≤–∏—Ç—å –¥–µ—Ñ–æ–ª—Ç–Ω—ã–π URL, –∏–ª–∏
- –∑–∞–¥–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è `VITE_SHEETS_API_URL`.

## 4) –ö–æ–Ω—Ç—Ä–∞–∫—Ç—ã API

- **GET** `.../exec?action=list` ‚Üí `{ employees: [...] }`
- **POST** `.../exec` body:
  - `{ action: "add", employee: {...} }` ‚Üí `{ employee: {...} }`
  - `{ action: "update", id: 123, updates: {...} }` ‚Üí `{ employee: {...} }`
  - `{ action: "delete", id: 123 }` ‚Üí `{ success: true }`


